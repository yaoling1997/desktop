一开始我以为直接在trie上DP就行了
结果犯了一个很2的错误
明明是一个串匹配多个串,应该用ac自动机的啊
然后按照白书上的说法改成了ac自动机
设f[i][j]表示当前在i号点,还需要走j步的概率,然后一个记忆化搜索就行了
一开始不知到怎么想的,每次配不上直接走0号点,接着改成了走fail
ac自动机要改一下,如果一个节点的没有符合当前字符出边,就改接它的fail的对应字符的出边,因为可以接着匹配,不过这样的实质和原来不停地while是一样的,都是走下一个匹配点的对应字符的出边,而且这样可以直接走,不需要while
