x:
利用矩阵的快速幂加速递推
一个形如f(n)=a1f(n-1)+a2f(n-2)+a3f(n-3)...adf(n-d)的式子(d比较小),求第n项mod mo是多少
可以利用矩阵的快速幂加速
设F(n)= f(n-d) f(n-d+1) ... f(n)
F(n-1)= f(n-d-1) f(n-d) ... f(n-1)
则F(n)= F(n-1)*A
可以推出A是
0 0 ..ad
1 0 ..ad+1
0 1 .. ad+2
...
然后变换n-d次就行了
相当于求F(d)*A^(n-d)然后输出结果矩阵(更准确地说应该是行向量)的第n项就行了
反正就是这么神奇
如果把状态表示成列向量,每一维都是某一个状态的线性组合,都可以考虑用矩阵乘法来做
Vt+1=A*Vt+BVt-1+CVt-2.... A,B,C是系数

x1:
又复习了一遍矩乘
如果用int的话,要注意一开始就对对入数据取mo(样例良心!)
感觉行向量比列向量好用一些
行向量*矩阵=行向量
矩阵*列向量=列向量
