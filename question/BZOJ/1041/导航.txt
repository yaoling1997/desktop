[HAOI2008]圆上的整点
数学题
先不考虑x or y=0的情况
x^2+y^2=r^2
y^2=(r+x)(r-x)
d= gcd((r+x),(r-x))
y^2= d^2*(r+x)/d*(r-x)/d
设A=(r-x)/d B=(r+x)/d,则A,B互质
y^2= d^2*A*B
由于A!=B,A*B是平方数,所以A,B分别是平方数不妨设A= a*a,B= b*b
由于A+B=2r/d
于是就变成了a*a+b*b=2r/d
d显然是2r的约数,不妨枚举,因为一个数的约数不超过sqrt(2r)个(小于sqrt(n)的约数与大于sqrt(n)的约数一一对应)
设a<b(即A<B,即x>0),对于对应的约数d,再次枚举a,仍然是根号2r/d枚举
算出b,若a*a与b*b的gcd为1(也可以视为a与b的gcd=1)则答案++
最后ans*4+4即可,对应于四个象限以及坐标轴上的4个点
