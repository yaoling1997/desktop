[NOI2006]最大获利
我以为最大权闭合图不能过,结果最慢的点0.5s就过了
好久没打网络流了
这道题最简单的做法就是最大权闭合图了,也很容易看出来(其实最大权闭合图什么的我好久没打了)
我们可以很容易地把问题转成最大权闭合图的模型
因为要获得一条边的收益,要花费钱建好这条边两个点才行
所以把边看成最大权闭合图里的点,向那两个点连边
最大权闭合图就是在转出来的那个图上找一个点权最大的闭合子图
闭合子图就是选了一个点,它的后继节点也必须选
然后转成网络流,点权化为边权,s向正权点连容量为正权的边,负权点向t连容量为绝对值的边,正权点向闭合图里的负权点连容量+oo的边
最后的答案就是正权点值的和-maxflow了
然后证明为什么最后的答案是正权点值的和-maxflow
其实我很久以前没想明白,现在再看别人的证明,好像能看懂了
首先设C为网络中一个割的容量(就是一个割的边权和)
由于中间的边是+oo,所以不可能被割掉
设s的最大权闭合图为N,t的最大权闭合图为M
C= M中正权点值之和+N中负权点值的绝对值之和(画个图就明白了)
设C=x1+y1
然后我们要求的是N这个图的权值,所以设W为N这个图的权值
W= N中正权点的和-N中负权点的绝对值的和
则W= x2-y1
C+W= x1+x2
显然,x1+x2就是所有正权点的权值和,设为T
C+W=T
W=T-C
为了使W最大,则C要最小,即C是最小割的容量
最小割=最大流,所以得证
反正是看懂了,尽管好像有点绕的样子
最奇怪的是这种做法竟然可以过,对于点数55000的图跑dinic竟然如此之快,太神奇了
也许跟容量比较少有关吧
