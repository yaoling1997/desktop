[Noi2011]阿狸的打字机
一直以为很难,尤其是很少碰字符串的题,更尤其是很少用ac自动机
以前见过这道题,以为很难就没管了
现在又不得不碾压这道题,于是打了遍模板就去看题解
题解......
看了很多人的题解,知道了查询(i,j)时相当于j到0号节点的那条链上有多少个点沿着fail指针走能走到i(这里的i,j是查询的i,j对应于trie树上的i,j)
然后换一个思路,就是把fail指针倒过来,就形成了一个fail树,相当于以i为根的子树中有多少个点在j的那条链上
然后可以设计出一个离线的算法,算法叫作: 树状数组维护dfs序
dfs序是fail树的dfs序,dfs序中一颗子树的所有节点标号一定是连续的,维护时可以转化为区间上的维护,反正先这样给trie树上的点按fail树的dfs序再标个号,每个点还记录一下以这个点为根的标号最大的点的标号是多少
反正这里纠结了半天,第二天问了cyb顿时恍然大悟(题解写得太渣了,看不懂)
然后dfs trie树,每次遇到一个点就把这个点对应于树状数组里的位置值+1,dfs出去时再-1,若这个点恰好代表一个或多个串,就处理别的串在这个串中出现多少次的询问,直接跳到对应的trie树上的点获得它管辖的这一段区间,看这一段有多少个点被染了即可
1A就是爽,1A多不容易啊
还是要找个时间练练字符串的题目,和ac自动机,后缀数组,后缀自动机增加感情,hash和kmp也一样
