月下柠檬树
simpson大法好！
首先,可以把树的投影看成很多个圆和它们公切线的面积,圆的投影是圆,线的投影是线
然后考虑怎么求面积
用simson!
首先只要求出上面那一部分的面积再*2就行了
求出相邻两个圆的公切线,只要上面的
然后用simpson积分求面积,每次扫所有的圆和线,用公式得出函数值就行了
有一个优化,就是减少调用F(x)的次数
每次求出某点的F后直接带到下一层去,这样明显快很多了
