[Noi2010]能量采集
数学太渣了
可以证明每个点(x,y)与(0,0)的连线上的点(包括自己,不包括(0,0))共有gcd(x,y)个
因为与(0,0)的连线过原点,而且影响点(x,y)的贡献的点在这条线y=kx上,k=y/x
若gcd(x,y)=1 则gcd(x*d,y*d)= d 而(x*d,y*d)与(x,y)是共线的
所以对于(x*d,y*d)有d-1个点影响它的贡献,即(x,y)有gcd(x,y)为所求
然后考虑gcd(x,y)的总个数是O(n)的,所以考虑能不能转化成直接枚举gcd
设g[i]表示i为公约数的点对个数,则有g[i]= (n/i)*(m/i)(不要写成n/i*m/i,否则会萎的)f[i]表示i为最大公约数的点对个数
然后用容斥原理f[i]= g[i]-sigmaf[j*i](j>=2且i*j<=n,i*j<=m)
然后从后往前推就行了,每次答案+= f[i]*()
