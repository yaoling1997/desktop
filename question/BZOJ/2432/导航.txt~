[Noi2011]兔农
全国赛day1第一题不见得一定是水题,也许它会放到day2
记得以前做过改了题面的一模一样的题,那是很久以前的事了,那时候还在用pascal,反正记得这道题还得了不少分,还被周雅君表扬了......养朱锋的小欧少
但是想A掉这道题,真不容易,做神题的后果就是做完后都不知道是怎么A的,一堆debug
出题人良心,实践证明50%的数据兔子不死
正解就是一堆的规律了
拿样例说明,样例是k=7
1 1 2 3 5 7 12 19 31 49 80 129 209 338 546 ......(1)
把数列(1)对k取模:
1 1 2 3 5 0 5 5 3 0 3 3 6 2 0 ......(2)
然后以死兔子的位置为分界点,将数列(2)分成很多份
1 1 2 3 5 0
5 5 3 0
3 3 6 2 0
......
任取一个子序列(单独成行的一段序列)可以发现
除最后一项外f[i]≡f[i-1]+f[i-2](mod k)
所以还可以发现,若一个子序列的第一项确定了,那么这个子序列的长度以及各项也就确定了,把每个子序列的第一项又看成一个序列,不妨设为序列(4),而一个子序列的第一项是上一个子序列的倒数第二项(观察出来的)
由于是mod k下的,所以序列(4)可能有循环节
然后我们还可以观察出一个规律:任取一个子序列,ai≡a1*Fi(mod k)
设子序列的最后一项为前两项的和,子序列长度为L,则有aL≡1(mod k)
即a1FL≡1(mod k)
知道FL便知道下一个子序列的首项了,但是在modk意义下a1不一定有逆元,a1要和k互质才行(求逆元用扩欧,判互补互质看gcd是不是1),否则没有逆元
有逆元的话就可以方便地求出FL,推出下一个子序列,否则当前子序列为无限循环序列,兔子不死,直接在这里面矩乘即可
若能找出循环节,可以证明长度不超过6*K
然后就是矩阵的事了,若有循环节,先把循环节前面那一坨干掉,再干循环节(把循环一次的矩阵搞出来,搞成循环次数次方)
不是还要定位不,找到位置(一路乘矩阵)后乘循环节矩阵就行了
没有循环节的话把死兔子的那一些序列干掉后就直接矩乘
反正调了一个下午加一个晚上,打错好多变量,少+1少-1
由于默认1,2月兔子不死,找循环节的时候忽略第一个子序列,从第二个找起,开Fibonacci的映射数组时要忽略1,2月
循环节还找错了(默认循环节开始位置是1),还傻X的把循环节起始位置改为2,发现仍然萎,最后才知道循环节前面也有可能有一大堆乱七八糟的,起始位置不是默认的,而是b[now]
然后还有从当前位置跳n步还是当前位置开始数第n步
反正一堆细节,慢慢打补丁,慢慢debug,总算熬过去了,代码长度也飞起来了
找规律什么的最讨厌了,就算找到规律了都不一定打得出来若是考场上直接裸的矩乘得那么多分也不错了,结合暴力还可以得更多分
