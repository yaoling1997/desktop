[Noi2008]假面舞会
想得八九不离十了就去看题解,题解用了一个很巧妙的dfs一遍的方法,一路标号
把图构好后,设顺着原来的有向边走点的编号加1,否则-1
如果下一个点是一个已经标过号的点,那么那玩意的长度最长为它将标的号-它已经标的号的绝对值,因为对于一个长度,它的gcd也一定可以,所以和原来已经求出来的gcd一下,最后gcd就是最长的了,至于最短的就是最小公约数了,最大公约数的大于等于3的最小约数
考虑为什么标号是对的,如果下一个点是已经标过号的点,那么它的标号肯定至少要跟当前点的父亲标号一样,那么等价长度就是这个了(相当于把下一个点看成它父亲,画个图就知道了)
如果所有的gcd出来是0,那么肯定无环,编号最大-编号最小就是最长了,若有多个连通分量,就把长度+起来,最短就是3了
无解就判一下就行了
