[NOI2006]网络收费
这道题关键在于转模型
转完模型后树形DP就可以了
怎么转呢?考虑到对于一个排列如果n^2的话肯定很慢,所以我们要转模型
考虑两个点i,j,设它们的lca为p,i与j的连通量为w
若i与p相同,j与p相同(相同代表类型相同),就不要收费
若i与p相同,j与p不同,就相当于,i与j要贡献w的费用,不妨看成是i不贡献,j贡献w
若i,j都与p不同,则i,j分别贡献w
然后很明显就变成O(n)算一个01状态的贡献了,从根一路算就是了,利用前缀和优化
然后就可以DP了
设状态f[s,n,p]表示当前点为s,当前点管辖的点有n个为A,祖先的情况为p
然后f[s,n,p]= min(f[l,i,p+o],f[r,n-i,p+o])枚举i就行了
o表示当前点是A还是B,可以通过n直接求出,l是左子树,r是右子树
如果当前点是叶子,先看看当前点的状态是不是和一开始给出的相同,不相同就加上C的代价,然后扫一遍祖先统计一下当前状态的答案就行了，统计答案就是把一段的F的和加起来,用前缀和优化
看上去好像是10^9,其实没有那么多,对于每个点n的状态个数乘以p的状态个数恰好为2^n+1个,从状态2^(2n+2)是开的下的
反正我直接用的二维vector,而且还调了半天
