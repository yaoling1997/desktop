[Noi2012]骑行川藏
简直是一道鬼题,要用到拉格朗日乘数法,然后只能现学现卖了
求一个多元函数f(x1,x2...)在限制φ(x1,x2...)=c的极值,就要用到这玩意
设拉格朗日函数L(x1,x2...)= f(x1,x2...)+λφ(x1,x2...)
分别对x1,x2...xn求偏导
偏导就是把要求的变量看作主元,其它的看作常数求导就行了
把导数设为0则有n+1个方程
fx1'+λφx1'=0
x2,x3......
第n+1个方程:φ(x1,x2...)=c
这道题目λ<0且φ随λ是单调的递增的,所以二分λ使得φ(x1,x2...)=c就行了
φ(vi)=∑ki*si*(vi-v'i)^2=E称为约束方程
-s1/v1^2 = λ*2*k1*s1*(v1-v'1)
-s2/v2^2 = λ*2*k2*s2*(v2-v'2)
......
由于每个方程是个一元三次方程,求个导发现可以二分确定零点
令导数=0就是vi=2/3vi'或vi=0,然后可以确定二分范围
求出所有的vi也就可以求φ了
不知道λ为什么<0且φ随λ递增,反正这道题挺鬼的
