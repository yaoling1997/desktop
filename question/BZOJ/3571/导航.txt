[Hnoi2014]画框
考场上表示只能拿30分
其实一开始我以为10分和30分是分开的,一共40,结果那10分竟然是包含在30分里的
30分就是费用流i向j连边取最小sigma就行了
一开始听到正解是最小乘积最大权匹配,我就有点虚,因为最小乘积什么的好像很神奇的样子,最小乘积生成树之类的题目我好像都没打过,然后一直以为很难
结果看了ydc的题解后觉得豁然开朗,看了代码后又少走了很多弯路,然后自己打一遍就一A了
然后讲讲怎么做好了,首先一个很神奇的转化
把sigma A和sigma B看成点(x,y),然后一个点对应一个解
然后显然我们不需要考虑所有的解,也不必求出所有可能的解,因为解的个数是阶乘级的
然后仔细想想,发现跟好像凸包有点联系,进一步发现答案肯定在下凸包上,还可以再进一步发现求出最左的点p1和最下的点p2,解将是它们之间的下凸包的点中的一个或多个(对于一个点画下反比例函数就知道了)
然后我们对于p1和p2可以方便地用KM求出(用spfa可能会T吧,没试过,也没听说有人用spfa过的),由于KM是最大权完美匹配,我们要使sigma A或sigma B最小来求出对应的点,所以要把A和B的权值取相反数再跑KM
求出p1,p2后接着求离p1p2最远的点c
然后求距离有|ax+by+c|/sqrt(a^2+b^2)
由于c在p1p2下面,所以绝对值可以去掉
然后就转化为求ax+by最小
x是sigma A y是sigma B
就变成了求a*sigma A+b*sigma B
然后又变成了sigma a*Ai+b*Bi
然后就变成一维情况再跑KM求出点c就行了
递归求,直到求出来的点c在p1p2上或以上就可以结束了
