好久没写Manacher了
复习一下
题意是求给定串的最长回文子串(n<=1e6)
本来想用来练习后缀数组的
但是算了下内存不够,开不下倍增表
然后只能写Manacher了
Manacher只能求出奇数长度的回文串
偶数长度的也算的话要在字符串每两个相邻字符之间添加'#'
字符串两头也要添加
然后设rad[i]为i的半径(至少为1)
然后i代表的回文子串的长度就是rad[i]-1
其基本思想是假如现在要求i的半径
由于1到i-1的半径都已经求出来了
设id为id+rad[id]-1最大的id
也就是往右边扩展得最远的id
若i在id到id+rad[id]-1里面
设i的关于id对称的位置为j
若rad[j]<mx-i+1
那么显然rad[i]=rad[j]
因为i,j关于id对称
所以j-rad[j]+1到j+rad[j]-1和i-rad[j]+1到i+rad[j]-1刚好相反
由于j-rad[j]+1到j+rad[j]-1是回文的
所以i-rad[j]+1到i+rad[j]-1也是回文的
由于j-rad[j]和j+rad[j]不同
所以i-rad[j]和i+rad[j]不同
所以rad[i]=rad[j]
若rad[j]>=mx-i+1
那么超出mx的部分显然是未知的
那么需要用传统方法继续扩展
由于最多扩展n次
每次不扩展为O(1)
所以总复杂度O(n)
