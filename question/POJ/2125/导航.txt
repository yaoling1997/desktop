题意
给不超过100个点5000条边的有向图
可以进行一些操作
选一个点i,删掉它的所有入边,代价为Wi+
选一个点i,删掉它的所有出边,代价为Wi-
要求删除所有的边
求最小代价方案
把不同操作看成点,边看作关系
每个点i对应两个操作(删除所有出边和删除所有入边)
所以就拆点为i和i+n吧
若有一条边<u,v>
就让u向v+n连一条有向边
表示要删除这条有向边得进行u操作或v+n操作
设i是属于X部的点,i+n是属于Y部的点
如果点权都为1就相当于二分图最小点覆盖了
对于点权不为1的情况
那就是二分图最小点权覆盖了
选某个点要花费这个点的点权的代价,并删掉这个点对应的边
要用到最小割
让s向X部的点i连容量为wi-的边
让Y部的点i+n向t连容量为wi+的边
X部与Y部的点的容量为+oo
那么不难发现网络中的一个割与一个点覆盖一一对应
若s与X部的某个点i的弧被割,表示要选i
若Y部的某个点i+n与t的弧被割,表示要选i+n
又因为每条边<u,v>对应的两个点至少一个被选
网络中与其对应的那条弧所连的节点u,v
s->u或v->t总有一条要删掉(<u,v>是+oo割不掉)
而点权和最小对应着割最小
所以最小点权覆盖与最小割一一对应
求完最小割后要输出方案
那就是X部被选的点和Y部被选的点
也就是S集合中的Y部的点和T集合中的X部的点为被选的点
输出对应的操作即可