先膜拜一下刘汝佳,orz
我在网络流这方面的经验不够多,这么简单的建图都没想出
假设我们检测答案D是否可行
把每个点u拆成d+1个点:u0,u1...ud
然后ui到ui+1连容量为+oo的边
表示第i天的在u号点的飞船可以待到i+1天
对于原图的边u,v
连ui->vi+1,vi->ui+1,容量都是1
表示第i天在u,第i+1天在v
第i天在v,第i+1天在u
然后超级源s向S0连容量为k的边
Ti向t连容量为+oo的边
然后跑最大流即可
但是可以发现若ui->vi+1,vi->ui+1同时满流
是不合法的
但它和ui->ui+1,vi->vi+1是等价的
所以输出方案时特殊处理这种情况
输方案就把k个飞船丢到队列里,用pos[]记录它们当前的位置
然后扫每个位置连出去的弧,有流量就把一个飞船丢过去,再把弧的流量-1
停留在原地的飞船是不行动的,只有到不同的点才输出
一直到所有飞船到T即可
敲之前觉得很难,敲完后还是觉得挺轻松的
然后一开始飞船的位置都是S,而不一定是1
(敲错了...还好有刘汝佳的代码,拿来对拍)
不加当前弧优化会tle...当前弧优化好厉害,让dinic跑得超快...
