好久没刷清橙了,正好清橙有一道莫队练手题
莫队算法是一种离线算法,处理不带修改的区间问题(我只知道不带修改的)
如果一个区间的答案可以由另一个区间得到,比如说
[l2,r2]的答案由[l1,r1]转移,转移代价是abs(l2-l1)+abs(r2-r1)的
就可以用莫队算法暴力做
本来要用到曼哈顿最小生成树的,把询问的左区间作为x,右区间作为y,然后构一颗MST dfs转移,反正可以证明这样做的复杂度是n^1.5的,我不会证明
但是曼哈顿最小生成数确实有点难打,我用treap打了100多行
wk教了我一个简单的替代品————分块,如果用分块的话,其实也挺快的,而且代码长度很短,总共100行
x:
分块代替MST的莫队算法
把所有询问按l从小到大排序,每n^0.5的询问内按r从小到大排序,每个块内的每一个元素的答案由前一个元素的答案转移
为什么是n^1.5的呢?因为每个块内r是递增的,l的浮动范围不超过n^0.5,每次转移的复杂度不超过n^0.5,共转移m次(m与n同级)所以总复杂度是n^1.5的
x1:
先建曼哈顿最小生成树,再在树上转移
实验证明确实比分块慢一倍,而且有点难打
其实算答案的时候不需要开数组映射,只需要在加的时候减掉原来的再加上新的就行了,建出最小生成树后随便处理一个点再dfs就行了,记得退栈时要还原数组
x2:n^2暴力
